<div ng-controller="gpuController">
    <div ng-if="gpuInfo.can_use_gpu">
        <h2 class="settings-section-title">GPU</h2>
        <div class="control-group">
            <label class="control-label">Use GPU</label>
            <div class="controls">
                <input name="should_use_gpu" type="checkbox" ng-model="config.should_use_gpu"/>
            </div>
        </div>
        <div ng-show="gpuInfo.can_use_gpu && config.should_use_gpu">
            <div class="control-group">
                <label class="control-label">GPU usage</label>
                <div class="controls">
                    <select dku-bs-select
                            name="gpu_usage"
                            ng-model="config.gpu_usage"
                            ng-options="gc.value as gc.label for gc in gpuInfo.gpu_usage_choices">
                    </select>
                </div>
            </div>
            <div ng-if="config.gpu_usage == 'custom'">
                <div class="control-group">
                    <label class="control-label">↳ Select GPU(s) to use</label>
                    <div class="controls">
                        <div name="gpu_list"
                            ng-model="config.gpu_list"
                            options='gpuInfo.gpu_list'
                            multiselect-field
                            required>
                        </div>
                    </div>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">GPU memory</label>
                <div class="controls">
                    <select dku-bs-select
                            name="gpu_memory_allocation_mode"
                            ng-model="config.gpu_memory_allocation_mode"
                            ng-options="gm.value as gm.label for gm in gpuInfo.gpu_memory_allocation_mode">
                    </select>
                </div>
            </div>
            <div ng-if="config.gpu_memory_allocation_mode == 'memory_limit'">
                <div class="control-group">
                    <label class="control-label">↳ Memory limit per GPU</label>
                    <div class="controls">
                        <div dku-slider value="config.gpu_memory_limit" style="width: 205px; display: inline-block;"
                             type="number" min="0" max="100"></div>
                        <span class="help-inline" style="vertical-align: top;">in %</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>